<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Coverage by Place of Residence vs. Occurrence • pahoabc</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Coverage by Place of Residence vs. Occurrence">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pahoabc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-guides" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Guides</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-guides">
<li><h6 class="dropdown-header" data-toc-skip>Modules</h6></li>
    <li><a class="dropdown-item" href="../articles/nominal_dropout_en.html">Nominal Dropout Rate</a></li>
    <li><a class="dropdown-item" href="../articles/residence_occurrence_en.html">Residence vs. Occurrence Coverage</a></li>
    <li><a class="dropdown-item" href="../articles/complete_schedule_en.html">Complete Schedule Coverage</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Other guides</h6></li>
    <li><a class="dropdown-item" href="../articles/example_datasets_en.html">Using our example datasets</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/IM-Data-PAHO/pahoabc/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Coverage by Place of Residence vs. Occurrence</h1>
                        <h4 data-toc-skip class="author">PAHO/CIM</h4>
            
            <h4 data-toc-skip class="date">April 9, 2025</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/IM-Data-PAHO/pahoabc/blob/v0.4.0/vignettes/residence_occurrence_en.Rmd" class="external-link"><code>vignettes/residence_occurrence_en.Rmd</code></a></small>
      <div class="d-none name"><code>residence_occurrence_en.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="rationale">Rationale<a class="anchor" aria-label="anchor" href="#rationale"></a>
</h2>
<p>It is common for Electronic Immunization Registries (EIR) to collect
both the place of residence and the place of occurrence of the
vaccination event. Vaccination coverage can be estimated by grouping
events according to either location. However, denominators are typically
estimated based on the place of residence.</p>
<p>Using either residence or occurrence as the numerator can lead to
underestimation or overestimation of coverage, and sometimes result in
values above 100%, especially in areas where vaccination services are
more available.</p>
<p>The residence vs. occurrence module in the PAHOabc package provides a
set of functions to explore and analyze this phenomenon.</p>
<blockquote>
<p><strong>Note</strong></p>
<p>All functions used for residence and occurrence analyses within
PAHOabc begin with the <code>roc_</code> prefix.</p>
</blockquote>
</div>
<div class="section level2">
<h2 id="coverage-analysis">Coverage Analysis<a class="anchor" aria-label="anchor" href="#coverage-analysis"></a>
</h2>
<div class="section level3">
<h3 id="expected-workflow">Expected Workflow<a class="anchor" aria-label="anchor" href="#expected-workflow"></a>
</h3>
<p>The <code><a href="../reference/roc_coverage.html">roc_coverage()</a></code> and <code><a href="../reference/roc_barplot.html">roc_barplot()</a></code>
functions work together to perform coverage analysis and visualization.
The <code><a href="../reference/roc_coverage.html">roc_coverage()</a></code> function computes vaccination coverage
by both residence and occurrence across selected administrative levels,
years, and vaccines. Its output (a data table) is structured to be
directly compatible with <code><a href="../reference/roc_barplot.html">roc_barplot()</a></code>, which generates a
visualization for a specific year and vaccine.</p>
<p>Alternatively, the <code><a href="../reference/roc_coverage_by.html">roc_coverage_by()</a></code> function is
available when you want to calculate coverage by either residence or
occurrence (but not both). While it produces a similar table, its output
is not compatible with <code><a href="../reference/roc_barplot.html">roc_barplot()</a></code>.</p>
<div class="float">
<img src="roc_workflow_1.svg" alt="Figure 1. Expected workflow for residence/occurrence coverage analysis."><div class="figcaption">Figure 1. Expected workflow for
residence/occurrence coverage analysis.</div>
</div>
</div>
<div class="section level3">
<h3 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h3>
<p>Here is a simple use case of the <code><a href="../reference/roc_coverage.html">roc_coverage()</a></code>
function, where we compute coverage by both metrics for the DTP1 vaccine
in 2023 for our example datasets.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># compute coverage</span></span>
<span><span class="va">coverage_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/roc_coverage.html">roc_coverage</a></span><span class="op">(</span></span>
<span>  data.EIR <span class="op">=</span> <span class="va">pahoabc.EIR</span>,</span>
<span>  data.schedule <span class="op">=</span> <span class="va">pahoabc.schedule</span>,</span>
<span>  data.pop <span class="op">=</span> <span class="va">pahoabc.pop.ADM1</span>,</span>
<span>  geo_level <span class="op">=</span> <span class="st">"ADM1"</span>,</span>
<span>  years <span class="op">=</span> <span class="fl">2023</span>, <span class="co"># this can be a vector of years</span></span>
<span>  vaccines <span class="op">=</span> <span class="st">"DTP1"</span> <span class="co"># this can be a vector of vaccines</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># show results in table</span></span>
<span><span class="va">coverage_df</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">kable</span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span>, caption <span class="op">=</span> <span class="st">"Vaccination coverage by ADM1 level"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Vaccination coverage by ADM1 level</caption>
<colgroup>
<col width="7%">
<col width="7%">
<col width="5%">
<col width="10%">
<col width="20%">
<col width="15%">
<col width="13%">
<col width="20%">
</colgroup>
<thead><tr class="header">
<th align="left">dose</th>
<th align="right">year</th>
<th align="right">age</th>
<th align="left">ADM1</th>
<th align="right">doses_applied</th>
<th align="right">population</th>
<th align="right">coverage</th>
<th align="left">coverage_type</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">DTP1</td>
<td align="right">2023</td>
<td align="right">0</td>
<td align="left">ADM1_1</td>
<td align="right">1413</td>
<td align="right">1703.145</td>
<td align="right">82.964</td>
<td align="left">residence</td>
</tr>
<tr class="even">
<td align="left">DTP1</td>
<td align="right">2023</td>
<td align="right">0</td>
<td align="left">ADM1_2</td>
<td align="right">6238</td>
<td align="right">6517.689</td>
<td align="right">95.709</td>
<td align="left">residence</td>
</tr>
<tr class="odd">
<td align="left">DTP1</td>
<td align="right">2023</td>
<td align="right">0</td>
<td align="left">ADM1_3</td>
<td align="right">27492</td>
<td align="right">30497.127</td>
<td align="right">90.146</td>
<td align="left">residence</td>
</tr>
<tr class="even">
<td align="left">DTP1</td>
<td align="right">2023</td>
<td align="right">0</td>
<td align="left">ADM1_4</td>
<td align="right">3678</td>
<td align="right">4081.329</td>
<td align="right">90.118</td>
<td align="left">residence</td>
</tr>
<tr class="odd">
<td align="left">DTP1</td>
<td align="right">2023</td>
<td align="right">0</td>
<td align="left">ADM1_5</td>
<td align="right">2010</td>
<td align="right">2645.993</td>
<td align="right">75.964</td>
<td align="left">residence</td>
</tr>
<tr class="even">
<td align="left">DTP1</td>
<td align="right">2023</td>
<td align="right">0</td>
<td align="left">ADM1_1</td>
<td align="right">1425</td>
<td align="right">1703.145</td>
<td align="right">83.669</td>
<td align="left">occurrence</td>
</tr>
<tr class="odd">
<td align="left">DTP1</td>
<td align="right">2023</td>
<td align="right">0</td>
<td align="left">ADM1_2</td>
<td align="right">9194</td>
<td align="right">6517.689</td>
<td align="right">141.062</td>
<td align="left">occurrence</td>
</tr>
<tr class="even">
<td align="left">DTP1</td>
<td align="right">2023</td>
<td align="right">0</td>
<td align="left">ADM1_3</td>
<td align="right">24494</td>
<td align="right">30497.127</td>
<td align="right">80.316</td>
<td align="left">occurrence</td>
</tr>
<tr class="odd">
<td align="left">DTP1</td>
<td align="right">2023</td>
<td align="right">0</td>
<td align="left">ADM1_4</td>
<td align="right">3705</td>
<td align="right">4081.329</td>
<td align="right">90.779</td>
<td align="left">occurrence</td>
</tr>
<tr class="even">
<td align="left">DTP1</td>
<td align="right">2023</td>
<td align="right">0</td>
<td align="left">ADM1_5</td>
<td align="right">2013</td>
<td align="right">2645.993</td>
<td align="right">76.077</td>
<td align="left">occurrence</td>
</tr>
</tbody>
</table>
<p>This output may be fed directly into the <code><a href="../reference/roc_barplot.html">roc_barplot()</a></code>
function as shown below.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># visualize output from roc_coverage()</span></span>
<span><span class="va">coverage_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/roc_barplot.html">roc_barplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">coverage_df</span>,</span>
<span>  year <span class="op">=</span> <span class="fl">2023</span>,</span>
<span>  vaccine <span class="op">=</span> <span class="st">"DTP1"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># show</span></span>
<span><span class="va">coverage_plot</span></span></code></pre></div>
<p><img src="residence_occurrence_en_files/figure-html/cov-viz-example-1.png" width="1152"></p>
<p>This chart shows the vaccination coverage achieved by each
subnational administrative level, considering both the place of
occurrence and the place of residence. The yellow bars represent
coverage by place of occurrence, meaning that the numerator includes all
doses administered in that location. The orange diamonds represent
coverage by place of residence, meaning that the numerator includes
people who reside in that location, regardless of where they received
the vaccine.</p>
<p>We can observe that the coverage by <strong>both residence and
occurrence</strong> in ADM1_1, ADM1_4, and ADM1_5 are similar. However,
in ADM1_2 and ADM1_3, there are differences between the two types of
coverage.</p>
<p>In ADM1_2, the coverage by occurrence reaches 141%, while the
coverage by residence is 95%, resulting in a difference of 46 percentage
points. In ADM1_3, the coverage by occurrence is 80%, while the coverage
by residence is 90%, with a difference of 10 percentage points in favor
of the coverage by residence.</p>
<p>These patterns suggest a meaningful population flow between
administrative areas. Specifically, in ADM1_2, the high coverage by
occurrence alongside lower coverage by residence indicates that many
individuals vaccinated in this area actually reside elsewhere.
Conversely, ADM1_3 shows higher coverage by residence than by
occurrence, suggesting that a significant number of its residents are
traveling to other areas to receive their vaccinations.</p>
</div>
</div>
<div class="section level2">
<h2 id="distribution-analysis">Distribution Analysis<a class="anchor" aria-label="anchor" href="#distribution-analysis"></a>
</h2>
<div class="section level3">
<h3 id="expected-workflow-1">Expected Workflow<a class="anchor" aria-label="anchor" href="#expected-workflow-1"></a>
</h3>
<p>The <code><a href="../reference/roc_distribution.html">roc_distribution()</a></code> and <code><a href="../reference/roc_heatmap.html">roc_heatmap()</a></code>
functions provide a way of analyzing population flow between
administrative areas. For example, one might be interested in observing
where people who reside in a single region get vaccinated (e.g., do they
all get vaccinated within their own region, or do they move to other
regions?).</p>
<p>Figure 2 shows the expected workflow for these functions.</p>
<div class="float">
<img src="roc_workflow_2.svg" alt="Figure 2. Expected workflow for distribution analysis"><div class="figcaption">Figure 2. Expected workflow for distribution
analysis</div>
</div>
</div>
<div class="section level3">
<h3 id="analysis-at-the-first-administrative-level">Analysis at the first administrative level<a class="anchor" aria-label="anchor" href="#analysis-at-the-first-administrative-level"></a>
</h3>
<p>This analysis only requires you to provide your EIR in conjunction
with other simple parameters. For example, let us compute how
vaccination is distributed at the first administrative level for the
DTP1 vaccine in 2022.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># compute distribution of doses for each place of residence</span></span>
<span><span class="va">distribution_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/roc_distribution.html">roc_distribution</a></span><span class="op">(</span></span>
<span>  data.EIR <span class="op">=</span> <span class="va">pahoabc.EIR</span>,</span>
<span>  vaccine <span class="op">=</span> <span class="st">"DTP1"</span>,</span>
<span>  geo_level <span class="op">=</span> <span class="st">"ADM1"</span>,</span>
<span>  birth_cohort <span class="op">=</span> <span class="fl">2022</span>,</span>
<span>  include_self_matches <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># show results in table (view only a couple of regions for simplicity)</span></span>
<span><span class="va">distribution_df</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ADM1_residence</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ADM1_1"</span>, <span class="st">"ADM1_3"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">kable</span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span>, caption <span class="op">=</span> <span class="st">"Vaccination distribution for each place of residence by place of occurrence"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Vaccination distribution for each place of residence by place
of occurrence</caption>
<thead><tr class="header">
<th align="left">ADM1_residence</th>
<th align="left">ADM1_occurrence</th>
<th align="right">frequency</th>
<th align="right">proportion</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">ADM1_1</td>
<td align="left">ADM1_2</td>
<td align="right">3</td>
<td align="right">0.003</td>
</tr>
<tr class="even">
<td align="left">ADM1_1</td>
<td align="left">ADM1_3</td>
<td align="right">7</td>
<td align="right">0.006</td>
</tr>
<tr class="odd">
<td align="left">ADM1_1</td>
<td align="left">ADM1_4</td>
<td align="right">1</td>
<td align="right">0.001</td>
</tr>
<tr class="even">
<td align="left">ADM1_1</td>
<td align="left">ADM1_1</td>
<td align="right">1176</td>
<td align="right">0.991</td>
</tr>
<tr class="odd">
<td align="left">ADM1_1</td>
<td align="left">ADM1_5</td>
<td align="right">0</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">ADM1_3</td>
<td align="left">ADM1_2</td>
<td align="right">3115</td>
<td align="right">0.113</td>
</tr>
<tr class="odd">
<td align="left">ADM1_3</td>
<td align="left">ADM1_3</td>
<td align="right">24364</td>
<td align="right">0.883</td>
</tr>
<tr class="even">
<td align="left">ADM1_3</td>
<td align="left">ADM1_4</td>
<td align="right">77</td>
<td align="right">0.003</td>
</tr>
<tr class="odd">
<td align="left">ADM1_3</td>
<td align="left">ADM1_1</td>
<td align="right">12</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">ADM1_3</td>
<td align="left">ADM1_5</td>
<td align="right">19</td>
<td align="right">0.001</td>
</tr>
</tbody>
</table>
<p>For example, 88% of people who reside in ADM1_3 got vaccinated for
DTP1 there as well. But an additional 11% received their DTP1
vaccination elsewhere (namely, in ADM1_2). If you want to further drill
into the people that got vaccinated in a place different from their
place of residence, you may set the <code>include_self_matches</code>
parameter to <code>FALSE</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># compute distribution of doses for each place of residence</span></span>
<span><span class="va">distribution_df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/roc_distribution.html">roc_distribution</a></span><span class="op">(</span></span>
<span>  data.EIR <span class="op">=</span> <span class="va">pahoabc.EIR</span>,</span>
<span>  vaccine <span class="op">=</span> <span class="st">"DTP1"</span>,</span>
<span>  geo_level <span class="op">=</span> <span class="st">"ADM1"</span>,</span>
<span>  birth_cohort <span class="op">=</span> <span class="fl">2022</span>,</span>
<span>  <span class="co"># set this to FALSE to exclude cases where people get vaccinated in their place of residence</span></span>
<span>  include_self_matches <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># show results in table (focus on ADM1_3 only for this example)</span></span>
<span><span class="va">distribution_df2</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ADM1_residence</span> <span class="op">==</span> <span class="st">"ADM1_3"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">kable</span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span>, caption <span class="op">=</span> <span class="st">"Where do residents of ADM1_3 get vaccinated?"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Where do residents of ADM1_3 get vaccinated?</caption>
<thead><tr class="header">
<th align="left">ADM1_residence</th>
<th align="left">ADM1_occurrence</th>
<th align="right">frequency</th>
<th align="right">proportion</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">ADM1_3</td>
<td align="left">ADM1_2</td>
<td align="right">3115</td>
<td align="right">0.966</td>
</tr>
<tr class="even">
<td align="left">ADM1_3</td>
<td align="left">ADM1_4</td>
<td align="right">77</td>
<td align="right">0.024</td>
</tr>
<tr class="odd">
<td align="left">ADM1_3</td>
<td align="left">ADM1_1</td>
<td align="right">12</td>
<td align="right">0.004</td>
</tr>
<tr class="even">
<td align="left">ADM1_3</td>
<td align="left">ADM1_5</td>
<td align="right">19</td>
<td align="right">0.006</td>
</tr>
</tbody>
</table>
<p>This shows that 97% of the people in ADM1_3 <strong>who do not get
vaccinated in their place of residence</strong>, get vaccinated in
ADM1_2.</p>
<p>A clearer picture of this can be provided by the
<code><a href="../reference/roc_heatmap.html">roc_heatmap()</a></code> function.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span> <span class="co"># to show them side by side</span></span>
<span></span>
<span><span class="co"># generate the plots</span></span>
<span><span class="va">distribution_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/roc_heatmap.html">roc_heatmap</a></span><span class="op">(</span><span class="va">distribution_df</span><span class="op">)</span> <span class="co"># with self matches</span></span>
<span><span class="va">distribution_plot2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/roc_heatmap.html">roc_heatmap</a></span><span class="op">(</span><span class="va">distribution_df2</span><span class="op">)</span> <span class="co"># without self matches</span></span>
<span></span>
<span><span class="co"># show them side by side</span></span>
<span><span class="va">distribution_plot</span> <span class="op">+</span> <span class="va">distribution_plot2</span></span></code></pre></div>
<p><img src="residence_occurrence_en_files/figure-html/dist-viz-example-1.png" width="1152"></p>
<blockquote>
<p><strong>Note</strong></p>
<p>The plot on the right shows the proportion of doses administered in a
place <strong>different from their place of residence</strong>. This is
why the diagonal is empty.</p>
</blockquote>
<p>These plots may be read either in a vertical or horizontal fashion.
When reading the plot vertically, the columns will sum to 100%. That is,
each column represents the population of, say, ADM1_1 and where they get
vaccinated. For example, if we concentrate on the plot on the right and
read it vertically, we may say that, of the total amount of people who
reside in ADM1_1 and get vaccinated in a place different from their
place of residence, 64% does so in ADM1_3, 27% in ADM1_2 and a remaining
9% in ADM1_4.</p>
<p>When reading horizontally, rows <strong>will not</strong> sum to
100%, but are still indicative of the residences of people getting
vaccinated in a certain region. For example, reading the plot on the
left in a horizontal fashion we may note that 94% of the residents of
ADM1_2 get vaccinated there as well, but this region also vaccinates a
significant proportion of residents of ADM1_3 (11%).</p>
</div>
<div class="section level3">
<h3 id="analysis-at-the-second-administrative-level">Analysis at the second administrative level<a class="anchor" aria-label="anchor" href="#analysis-at-the-second-administrative-level"></a>
</h3>
<p>An analysis at a more granular level is beneficial in this case. Let
us repeat the above process, but at the second administrative level
(e.g., districts within a certain region).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># compute distribution of doses for each place of residence at second</span></span>
<span><span class="co"># administrative level (focus on ADM1_3 only for this example)</span></span>
<span><span class="va">distribution_df3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/roc_distribution.html">roc_distribution</a></span><span class="op">(</span></span>
<span>  data.EIR <span class="op">=</span> <span class="va">pahoabc.EIR</span>,</span>
<span>  vaccine <span class="op">=</span> <span class="st">"DTP1"</span>,</span>
<span>  geo_level <span class="op">=</span> <span class="st">"ADM2"</span>,</span>
<span>  birth_cohort <span class="op">=</span> <span class="fl">2022</span>,</span>
<span>  include_self_matches <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  within_ADM1 <span class="op">=</span> <span class="st">"ADM1_3"</span> <span class="co"># set the region to drill into</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># show results in plot </span></span>
<span><span class="va">distribution_plot3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/roc_heatmap.html">roc_heatmap</a></span><span class="op">(</span></span>
<span>  <span class="va">distribution_df3</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># show</span></span>
<span><span class="va">distribution_plot3</span></span></code></pre></div>
<p><img src="residence_occurrence_en_files/figure-html/dist-analysis-example-3-1.png" width="1152"></p>
<p>In this heatmap, we observe the proportion of vaccination events that
take place in a location different from the place of residence, broken
down by the second administrative level.</p>
<p>As an example, it is notable that among all individuals residing in
ADM2_3_10 who are vaccinated outside their area of residence, 71%
receive their vaccine in ADM2_3_11. Similarly, 44% of individuals from
ADM2_3_23 who are vaccinated elsewhere are also vaccinated in
ADM2_3_11.</p>
<p>Looking at the heatmap horizontally, we can see that ADM2_3_20
provides vaccinations to a large number of people coming from other
areas: 22% of those from ADM2_3_12, 21% from ADM2_3_15, 22% from
ADM2_3_17, 11% from ADM2_3_18, and 36% from ADM2_3_7 are vaccinated
there.</p>
<p>The top row is also interesting, since it indicates people getting
vaccinated outside of ADM1_3 entirely. For example, in column 4, 86% of
the residents of ADM3_3_13 get vaccinated outside of ADM1_3, suggesting
a strong population flow.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.paho.org/en" class="external-link"><img src="reference/figures/pahobrand-blue-stacked-2024-en.png" height="100" alt="PAHO"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
